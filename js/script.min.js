var mySwiper = new Swiper(".start__container", {
    direction: "horizontal",
    loop: true,
    slidesPerView: 1,
    autoplay: {
        delay: 1000,

    },
    speed: 1000,

}),
    mySwiperGAL = new Swiper(".gallery__right", {
        direction: "horizontal",
        autoHeight: true,
        navigation: { nextEl: ".btn__right", prevEl: ".btn__left" },
        breakpoints: {
            320: {
                slidesPerView: 'auto',
                slidesPerGroup: 2,
                slidesPerColumn: 0,
                spaceBetween: 0,
                width: 'auto',
            },
            700: {
                slidesPerView: 1,
                slidesPerGroup: 1,
                slidesPerColumn: 1,
                width: 'auto',
                slidesPerColumnFill: "column",
                spaceBetween: 0,
            },
            768: {
                slidesPerView: 2,
                slidesPerGroup: 2,
                width: 666,
                spaceBetween: 35,
                slidesPerColumn: 2,
                slidesPerColumnFill: "row",
            },
            1024: {
                spaceBetween: 32,
                slidesPerView: 2,
                slidesPerGroup: 2,
                slidesPerColumn: 2,
                slidesPerColumnFill: "row",
            },
            1920: {
                slidesPerView: 3,
                slidesPerGroup: 3,
                spaceBetween: 50,
                slidesPerColumn: 2,
                slidesPerColumnFill: "row",
                width: 1150,

            },
        },
        pagination: {
            el: ".list__counter",
            type: "fraction",
            renderFraction: function (e, t) {
                return (
                    '<span class = "' +
                    e +
                    '"></span>  /  <span class ="' +
                    t +
                    ' " ></span>'
                );
            },
        },
    });

let mySwiper1;
var mySwiperEV = document.querySelector(".events__container");
function mobileSlider() {
    window.innerWidth <= 681 &&
        "false" == mySwiperEV.dataset.mobile &&
        ((mySwiper1 = new Swiper(mySwiperEV, {
            slidesPerView: "auto",
            slidesPerGroup: 1,
            slideClass: "events-slide",
            loop: !1,
            pagination: { el: ".swiper-pagination" },
        })),
            (mySwiperEV.dataset.mobile = "true")),
        window.innerWidth > 681 &&
        mySwiper1 &&
        ((mySwiperEV.dataset.mobile = "false"), mySwiper1.destroy());
}
mobileSlider(),
    window.addEventListener("resize", () => {
        mobileSlider();
    });
let eventBlockActive = document.querySelector(".events__container"),
    eventBlockButton = document.querySelector(".events__button");
eventBlockButton.addEventListener("click", function (e) {
    (e.target.style.display = "none"),
        eventBlockActive.classList.toggle("active-event");
});
var mySwiperED = new Swiper(".editions__books", {
    spaceBetween: 50,
    slidesPerView: 3,
    slidesPerGroup: 3,
    setWrapperSize: !0,
    edgeSwipeThreshold: 0,
    navigation: {
        nextEl: ".btn__editions-right",
        prevEl: ".btn__editions-left",
    },
    breakpoints: {
        0: { direction: "none" },
        320: {
            direction: "vertical",
            slidesPerColumn: 2,
            spaceBetween: 0,
            slidesPerView: "auto",
        },
        680: {
            direction: "vertical",
            slidesPerColumn: 2,
            spaceBetween: 49,
            slidesPerColumnFill: "row",
            slidesPerView: "auto",
            slidesPerGroup: "auto",
        },
        681: { direction: "horizontal", spaceBetween: 0 },
        768: {
            direction: "horizontal",
            slidesPerView: 2,
            spaceBetween: -19,
            slidesPerGroup: 1,
        },
        1024: { slidesPerView: 2, spaceBetween: 45 },
        1400: { slidesPerView: 3, },
        1920: {
            width: 1162
        }
    },
    pagination: {
        el: ".list__counter",
        type: "fraction",
        renderFraction: function (e, t) {
            return (
                '<span class = "' +
                e +
                '"></span>  /  <span class ="' +
                t +
                ' " ></span>'
            );
        },
    },
}),
    mySwiperPAR = new Swiper(".partners__container", {
        direction: "horizontal",
        slidesPerView: 3,
        spaceBetween: 30,
       
        navigation: {
            nextEl: ".btn__partners-right",
            prevEl: ".btn__partners-left",
        },
        breakpoints: {
            320: { slidesPerView: 'auto', spaceBetween: 24 },
            768: { slidesPerView: 2, spaceBetween: 0 },
            1024: { slidesPerView: 1, spaceBetween: 0 ,  width:435,},
            1450: { slidesPerView: 3 },
            1920: { slidesPerView: 3 },
        },
        autoplay: { delay: 1e3 },
        speed: 800,
    });
let galleryRight = document.querySelector(".gallery__right"),
    galleryFilter = document.querySelector(".gallery__filter-full");
document.body.offsetWidth <= 768 && galleryFilter.prepend(galleryRight);
let contries = document.querySelectorAll(".history__img");
contries.forEach((e) => {
    e.addEventListener("click", function () {
        contries.forEach((e) => {
            e.children[0].classList.remove("history__line-active");
        }),
            e.children[0].classList.add("history__line-active");
    });
});
$('.link-bottom').on('click', function (e) {

    console.dir(e.target)
    $(e.target).children().children().addClass('active-icon');
    $('.header__content').removeClass('header__content--active');
    $(e.target.parentElement.lastElementChild).toggleClass('header__content--active');
});

let btnCategories = $(".header__elem-bottom");
let categories = $(".header__content");

$(document).mouseup(function (e) {
    if (!btnCategories.is(e.target) && btnCategories.has(e.target).length === 0 &&
        !categories.is(e.target) && categories.has(e.target).length === 0
    ) {
        $('.link-bottom').children().children().removeClass('active-icon');
        categories.removeClass('header__content--active');
    }
});

window.addEventListener("DOMContentLoaded", function () {
    $(".history__title-button").click(function () {
        $('.history__button').removeClass('history__button-active');
        $(this).children('.history__button').toggleClass('history__button-active');
        $(this).next(".slide").toggleClass("slide__active");

    });
    $('.accordion').accordion({
        heightStyle: 'content'
    });
    $(".history__item").click(function () {
        if ($(this).text() == 'Доменико Гирландайо') {
            $('.history__item').removeClass('history__link-active')
            $('.history__active-content').removeClass('disable-content')
            $('.history__disable-content').removeClass('active-content')
            $('.history__active-content').addClass('active-content')
            $('.history__disable-content').addClass('disable-content')
        } else {
            $('.history__item').removeClass('history__link-active')
            $(this).addClass('history__link-active')
            $('.history__active-content').removeClass('active-content')
            $('.history__disable-content').removeClass('disable-content')
            $('.history__active-content').addClass('disable-content')
            $('.history__disable-content').addClass('active-content')
        }


    })
}),
    (function () {
        const e = document.querySelector(".header__burger");
        e.addEventListener("click", () => {
            e.classList.toggle("active");
        });
    })(),
    $(".header__burger").click(function () {
        $(".header__menu, .header__list").toggleClass("is-active"),
            $("body").toggleClass("lock");
    });
let flag = 0;
window.addEventListener("scroll", function () {
    if (
        window.scrollY >= 4500 - document.querySelector("#map").offsetTop &&
        0 == flag
    ) {
        ymaps.ready(function () {
            var e = new ymaps.Map("map", { center: [55.76, 37.64], zoom: 14 });
            e.controls.remove("zoomControl"),
                e.controls.remove("searchControl"),
                e.controls.remove("trafficControl"),
                e.controls.remove("typeSelector"),
                e.controls.remove("trafficControl"),
                e.controls.remove("trafficControl"),
                e.controls.remove("fullscreenControl"),
                e.controls.remove("rulerControl"),
                e.controls.remove("geolocationControl");
            var t = new ymaps.control.GeolocationControl({
                options: { position: { right: 15, top: 360 }, size: "small" },
            });
            e.controls.add(t);
            var i = new ymaps.control.ZoomControl({
                options: { position: { right: 15, top: 270 }, size: "small" },
            });
            e.controls.add(i);
            e.geoObjects.add(new ymaps.Placemark([55.758468, 37.601088], {
                hintContent: 'Леонтьевский переулок, дом 5/1',
                balloonContent: [
                    '<address>',
                    '<strong>Наш офис в Москве</strong>',
                    '<br/>',
                    'Адрес: Москва, ул. Леонтьевский переулок, дом 5/1',
                    '<br/>',
                    'Подробнее: <a href="https://company.yandex.ru/">https://company.yandex.ru</a>',
                    '</address>'
                ].join('')


            },
                {
                    iconLayout: 'default#image',
                    iconImageHref: 'img/icon/marker.svg',
                    iconImageSize: [20, 20],

                },


            ))
        }),

            (flag = 1);

        let e = document.querySelector(".contacts__left"),
            t = document.querySelector("#map");
        document.body.offsetWidth <= 450 && e.prepend(t);
    }
});

document.addEventListener("click", function (e) {
    "active-icon" == e.target.classList && console.log(e.target);
});
let inputForm = document.querySelectorAll(".form input");
inputForm.forEach((e) => {
    e.addEventListener("click", function () {
        inputForm.forEach((e) => {
            e.classList.remove("form-active");
        }),
            e.classList.add("form-active");
    });
});
const element = document.querySelector(".gallery__author"),
    choices = new Choices(element, {
        searchEnabled: !1,
        searchChoices: !1,
        position: "bottom",
        shouldSort: !1,
        duplicateItemsAllowed: !1,
        resetScrollPosition: !1,
        classNames: {
            containerOuter: "choices",
            containerInner: "choices__inner",
            input: "choices__input",
            inputCloned: "choices__input--cloned",
            list: "choices__list",
            listItems: "choices__list--multiple",
            listSingle: "choices__list--single",
            listDropdown: "choices__list--dropdown",
            item: "choices__item",
            itemSelectable: null,
            itemDisabled: "choices__item--disabled",
            itemOption: "choices__item--choice",
            group: "choices__group",
            groupHeading: "choices__heading",
            button: "choices__button",
            activeState: "is-active",
            focusState: "is-focused",
            openState: "is-open",
            disabledState: "is-disabled",
            highlightedState: "is-highlighted",
            selectedState: "is-selected",
            flippedState: "is-flipped",
            selectedState: "is-highlighted",
        },
    });
var selector = document.querySelector("input[type='tel']"),
    im = new Inputmask("+7 (999)-999-99-99");
im.mask(selector);
let valid = new JustValidate(".form", {
    errorFieldCssClass: 'is-invalid',
    rules: {
        name: {
            required: !0,
            minLength: 2,
            maxLength: 30,
            function: () => {
                if (!document.querySelector(".form__name").value.match(/\d/g))
                    return valid.messages.name.function;
            },
        },
        tel: {
            required: !0,
            function: () => {
                const e = selector.inputmask.unmaskedvalue();
                return Number(e) && 10 === e.length;
            },
        },
    },
    messages: {
        name: {
            required: "это поле обязательное",
            remote: " Такое имя уже есть!",
            name: "введите правильно",
            minLength: "введите как минимум 2 символа",
            maxLength: "Введите от 2 до 30 символов",
            function: "выввели цифры",
        },
        tel: {
            remote: " Такое телефон  уже используется!",
            tel: "введите правильно",
            function: "введено не корректно",
            required: "это поле обязательное",
        },
    },
});
$(".form").submit(function () {
    var e = $(this);
    let t = $(".mess");
    $.ajax({
        type: "POST",
        url: "foo.php",
        data: e.serialize(),
        error: function () {
            t.html('<div class="alert alert-danger">Ошибка отправки!</div>');
        },
        success: function () {
            t.html(
                '<div class="alert alert-success">Собщение успешно отправленно!</div>'
            ),
                setTimeout(function () {
                    e.trigger("reset");
                }, 2e3);
        },
    });
}),
    $(document).ready(function () {
        $('a[href^="#"], *[data-href^="#"]').click(function () {
            elementClick = $(this).attr("href")
            destination = $(elementClick).offset().top;
            $("html:not(:animated),body:not(:animated)").animate({ scrollTop: destination - 160 }, 1100);
            return false;
        });
    });

$(document).ready(function () {
    if ($(window).width() <= 1470) {
        $('.unity-top').append($('.header__search-full'));
    }
    if ($(window).width() <= 450) {
        $('.editions__all-category--new').append($('.ed__elem-4'));
        $('.editions__elem').addClass('active-2')
        $('.ed__elem-4').removeClass('active-2');
        $('.ed__elem-4').children('.editions__elem-button').addClass('editions__elem-button--acive');
        $('#category-4').prop('checked', true);

        $('.category__list-title').click(function () {
            $('.editions h2').toggleClass('h2-active');
            $('.editions__all-category').toggleClass('active--editions__all-category');
        });

        $('body').on('click', '.active-2', function () {
            $('.editions__all-category--new').append($(this).addClass('active-elem'));
            $(this).removeClass('active-2')
            $(this).children('.editions__elem-button').addClass('editions__elem-button--acive')
            $('.editions__all-category').removeClass('active--editions__all-category');
            $('.category__list-title').removeClass('h2-active');
        });

        $('body').on('click', '.editions__elem-button', function () {
            let deleteElem = $(this).parent()
            if (!$('.editions__all-category').is(deleteElem)) {
                deleteElem = deleteElem.remove()
                deleteElem.addClass('active-2')
                $('input[type="checkbox"]').prop('checked', false);
                $(this).removeClass('editions__elem-button--acive');
                $('.editions__all-category').append(deleteElem.removeClass('active-elem'))
            }
        })

    }
    if ($(window).width() <= 1024) {
        $('.header__search-full').append('<button class="header__search-sumbit" type="submit"></button>')
        $('.header__button').on('click', function (e) {
            e.preventDefault()
            $('.header__search').toggleClass('search-active');
            $('.header__search-sumbit').toggleClass('header__search-sumbit-active')
        })
    }
});




// цена 

function prettify(num) {
    var n = num.toString();
    var separator = " ";
    return n.replace(/(\d{1,3}(?=(?:\d\d\d)+(?!\d)))/g, "$1" + separator);
}

var $test = $(".cost-price-2");
var val = $test.prop("value");
$test.prop("value", prettify(val));

// категории

$('.editions__category').keypress(function (e) {
    if (e.keyCode == 13) {
        $(this).attr('visibility', 'inherit');
    }
});

// Войти всплывающее окно 

$('.akk-log-in__sing-up').on('click', function () {
    $('.akk-sing-in__content').toggleClass('sing-in__active');
})
$('.header__akk').on('click', function () {
    $('.header__log-in').toggleClass('sing-in__active');
    $('.akk-log-in').toggleClass('sing-in__active');

})
$('.akk-log-in__sing-up').on('click', function () {
    $('.akk-log-in').removeClass('sing-in__active');

});
$('.akk-log-in__background').on('click', function () {
    $('.header__log-in').removeClass('sing-in__active');
    $('.akk-log-in').removeClass('sing-in__active');
    $('.akk-sing-in').removeClass('sing-in__active');
})
